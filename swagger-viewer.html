<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>API Spec Viewer</title>
  <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui.css">
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }
    #header {
      background: #f5f5f5;
      padding: 20px;
      border-bottom: 2px solid #ddd;
    }
    h1 {
      color: #333;
      margin: 0 0 10px 0;
    }
    .info {
      color: #666;
      font-size: 14px;
    }
    .folder-section {
      border: 1px solid #ddd;
      padding: 15px;
      margin: 15px 20px;
      border-radius: 5px;
      background: #fafafa;
    }
    .folder-section h2 {
      margin-top: 0;
      color: #0066cc;
    }
    button {
      margin: 5px 5px 0 0;
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
      background: #0066cc;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background: #004c99;
    }
    #swagger-ui {
      display: none;
      margin-top: 20px;
    }
    #api-list {
      padding-bottom: 20px;
    }
    .back-button {
      margin: 20px;
      display: none;
    }
    .swagger-ui .topbar {
      display: none;
    }
  </style>
</head>
<body>
  <div id="header">
    <h1>API Spec Viewer</h1>
    <p class="info">
      Click a YAML button to open the API docs in Swagger UI.<br>
      Serve this folder (e.g., <code>python -m http.server 8000</code>) before opening the viewer.
    </p>
  </div>

  <div id="api-list">
    <div class="folder-section">
      <h2>FaaS Backend API (Core Services)</h2>
      <p>
        Specification for the Function as a Service backend.<br>
        <strong>Includes:</strong> Workspace CRUD, Function CRUD, Logs, Build & Deploy (WASM build, ECR push, SpinApp deploy).
      </p>
      <button onclick="loadSwagger('apiSpec/faas-backend/faas-api.yaml')">faas-api.yaml</button>
    </div>
  </div>

  <button class="back-button" id="backButton" onclick="goBack()">Back to list</button>
  <div id="swagger-ui"></div>

  <script src="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui-bundle.js"></script>
  <script src="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui-standalone-preset.js"></script>
  <script>
    let currentUI = null;

    function loadSwagger(yamlPath) {
      document.getElementById('api-list').style.display = 'none';
      document.getElementById('swagger-ui').style.display = 'block';
      document.getElementById('backButton').style.display = 'block';

      const fullYamlUrl = window.location.origin + '/' + yamlPath;

      currentUI = SwaggerUIBundle({
        url: fullYamlUrl,
        dom_id: '#swagger-ui',
        deepLinking: true,
        presets: [
          SwaggerUIBundle.presets.apis,
          SwaggerUIStandalonePreset
        ],
        layout: 'StandaloneLayout'
      });
    }

    function goBack() {
      document.getElementById('api-list').style.display = 'block';
      document.getElementById('swagger-ui').style.display = 'none';
      document.getElementById('backButton').style.display = 'none';
    }
  </script>
</body>
</html>
